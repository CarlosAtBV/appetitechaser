//===========================================================================
//
// Mel's Melee Style
//
// by Cardboard Marty
// Sprites by Cardboard Marty, Blox, Scuba Steve, Banjo Entertainment
// 
//
//===========================================================================

ACTOR MelMelee : TSPMelBaseWeapon
{
  Inventory.PickupMessage "You relearned your fighting style you apparently dropped [Class: Melee, Slot 1]"
  Obituary "%o learned why %k is the king of the iron fist."
  Weapon.Kickback 100
  Weapon.BobStyle Alpha
  Weapon.BobSpeed 1.5
  Weapon.BobRangeY 1.0
  Weapon.BobRangeX 0.5
  Tag "Melee"
  +WEAPON.WIMPY_WEAPON
  +WEAPON.MELEEWEAPON
  +WEAPON.NOALERT
  +WEAPON.NOAUTOAIM
  +WEAPON.NOAUTOFIRE
  +NOEXTREMEDEATH
  +INVENTORY.UNDROPPABLE
  States
  {
  Spawn:
    TNT1 A -1
    Loop
  Deselect:
    TNT1 A 0 A_TakeInventory("MeleeSelected", 1)
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_TakeInventory("MelAlternateCombo", 99)
    TNT1 A 0 A_TakeInventory("MelMachCombo", 99)
    TNT1 A 0 A_JumpIfInventory("ComboCoolDown", 1, "ComboDeselect")
    TNT1 A 0 A_JumpIfInventory("MelPistolCombo", 1, "ComboDeselect")
    TNT1 A 0 A_TakeInventory("ComboCoolDown", 99)
    TNT1 A 0 A_TakeInventory("MelPistolCombo", 99)
    MLED ABCDE 1
    TNT1 A 3
  DeselectLoop:
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAA 0  A_Lower
    TNT1 A 1 A_Lower
    Loop
  Select:
    TNT1 A 0 A_GiveInventory("MeleeSelected", 1)
    TNT1 A 4 SetPlayerProperty(0,1,2)
    MLEU ABCDE 1
  SelectLoop:
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAA 0  A_Raise
    MLEG A 1 A_Raise
    Loop
  Ready:
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTraitStart")
    MLEG A 1 A_WeaponReady
    Loop
	
//Punch!
  Fire:
    TNT1 A 0 A_JumpIfInventory("MagPushToken", 1,"MagPush")
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML1F A 0 A_JumpIfInventory("MelMachCombo",4,"AfterMelee") //made so you can't knifehand again after the Rapid Fire Finish
    ML1F A 0 A_JumpIfInventory("MelMachCombo",3,"RapidFireFinish")
    ML1F A 0 A_JumpIfInventory("MelMachCombo",2,"CrossDuo")
    ML1F A 0 A_JumpIfInventory("MelMachCombo",1,"CrossPunch")
    ML1F A 0 A_JumpIfInventory("MelAlternateCombo",2,"KnifeHand")
    ML1F A 0 A_JumpIfInventory("MelPrimaryCombo",3,"ScorpionTailFinisher")
    ML1F A 0 A_JumpIfInventory("MelPrimaryCombo",2,"LeftOverhead")
    ML1F A 0 A_JumpIfInventory("MelPrimaryCombo",1,"RightHook")
	
  // P DEFAULT
  DefaultPunch:
	ML1F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    ML1F ABCD 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"FireBerserk")
    ML1F E 1 A_CustomPunch(10,0,0,"BasicMeleePuff",70)
    Goto FireA
  FireBerserk:
    ML1F E 1 A_CustomPunch(15,0,0,"BasicMeleePuff",70)
    Goto FireA
	
  // P END
  FireA:
    TNT1 A 0 A_GiveInventory("MelPrimaryCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML1F F 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML1F G 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML1F J 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML1F K 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
	TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    Goto AfterMelee
	
// DEFAULT P-P
  RightHook:
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    ML2F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"RightHookBerserk")
    ML2F D 1 A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto RightHookA
  RightHookBerserk:
    ML2F D 1 A_CustomPunch(24,0,0,"BasicMeleePuff",70)
    Goto RightHookA

// P-P END
  RightHookA:
    ML2F E 1
    TNT1 A 0 A_GiveInventory("MelPrimaryCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML2F H 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    Goto AfterMelee
	
//P-P-P DEFAULT
  LeftOverhead:
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot6")
    ML2F A 0 A_PlaySound("*melee")
    ML3F ABC 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"LeftOverheadBerserk")
    ML3F E 1 A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto LeftOverheadA
  LeftOverheadBerserk:
    ML3F E 1 A_CustomPunch(24,0,0,"BasicMeleePuff",70)
    Goto LeftOverheadA

// P-P-P END
  LeftOverheadA:
    ML3F F 1
    TNT1 A 0 A_GiveInventory("MelPrimaryCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 G 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 J 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 3
    Goto AfterMelee
	
// P-P-P-P DEFAULT
  ScorpionTailFinisher:
    TNT1 A 5 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
    ML4F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"ScorpionTailFinisherBerserk")
    ML4F D 1 A_CustomPunch(14,0,0,"UppercutMeleePuff",90)
    ML4F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    ML4F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    ML4F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    ML4F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    Goto ScorpionTailFinisherA
  ScorpionTailFinisherBerserk:
    ML4F D 1 A_CustomPunch(28,0,0,"UppercutMeleePuff",90)
    ML4F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    ML4F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    ML4F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    ML4F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto ScorpionTailFinisherA

// P-P-P-P END
  ScorpionTailFinisherA:
    ML4F E 2
    ML4F DCBA 1
    TNT1 A 8
    Goto AfterMelee
	
// K-K-P DEFAULT
  KnifeHand:
    ML2F A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
    ML5F ABC 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"KnifeHandBerserk")
    ML5F D 1 A_CustomPunch(14,0,0,"StrongMeleePuff",70)
	Goto KnifeHandA
  KnifeHandBerserk:
    ML5F D 1 A_CustomPunch(24,0,0,"BasicMeleePuff",70)
    Goto KnifeHandA

// K-K-P SF
  SFKnifeHand:
    ML2F A 0 A_PlaySoundEX("sfstrongmelee/miss", "SoundSlot5")
    ML5F ABC 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"SFKnifeHandBerserk")
    ML5F D 1 A_CustomPunch(14,0,0,"SFStrongMeleePuff",70)
	Goto KnifeHandA
  SFKnifeHandBerserk:
    ML5F D 1 A_CustomPunch(24,0,0,"SFBasicMeleePuff",70)
    Goto KnifeHandA	

// K-K-P MK
  MKKnifeHand:
    ML2F A 0 A_PlaySoundEX("mkstrongmelee/miss", "SoundSlot5")
    ML5F ABC 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"MKKnifeHandBerserk")
    ML5F D 1 A_CustomPunch(14,0,0,"MKStrongMeleePuff",70)
	Goto KnifeHandA
  MKKnifeHandBerserk:
    ML5F D 1 A_CustomPunch(24,0,0,"MKBasicMeleePuff",70)
    Goto KnifeHandA	
	
// K-K-P 64
  64KnifeHand:
    ML2F A 0 A_PlaySoundEX("64strongmelee/miss", "SoundSlot5")
    ML5F ABC 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"64KnifeHandBerserk")
    ML5F D 1 A_CustomPunch(14,0,0,"64StrongMeleePuff",70)
	Goto KnifeHandA
  64KnifeHandBerserk:
    ML5F D 1 A_CustomPunch(24,0,0,"64BasicMeleePuff",70)
    Goto KnifeHandA	
	
// K-K-P END
  KnifeHandA:
    ML5F EFG 1
    TNT1 A 0 A_GiveInventory("MelMachCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML5F H 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML5F I 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 5
    Goto AfterMelee
	
// K-K-P-P DEFAULT
  CrossPunch:
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 1,"SFCrossPunch") // SF
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 2,"MKCrossPunch") // MK2
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 3,"64CrossPunch") // Smash 64
    TNT1 A 2 A_PlaySound("*melee")
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    ML6F AB 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"CrossPunchBerserk")
    ML6F D 1 A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto CrossPunchA
  CrossPunchBerserk:
    ML6F D 1 A_CustomPunch(24,0,0,"BasicMeleePuff",70)
    Goto CrossPunchA

// K-K-P-P SF
  SFCrossPunch:
    TNT1 A 2 A_PlaySound("*melee")
    ML2F A 0 A_PlaySoundEX("sfbasicmelee/miss", "SoundSlot5")
    ML6F AB 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"SFCrossPunchBerserk")
    ML6F D 1 A_CustomPunch(12,0,0,"SFBasicMeleePuff",70)
    Goto CrossPunchA
  SFCrossPunchBerserk:
    ML6F D 1 A_CustomPunch(24,0,0,"SFBasicMeleePuff",70)
    Goto CrossPunchA

// K-K-P-P MK
  MKCrossPunch:
    TNT1 A 2 A_PlaySound("*melee")
    ML2F A 0 A_PlaySoundEX("mkbasicmelee/miss", "SoundSlot5")
    ML6F AB 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"MKCrossPunchBerserk")
    ML6F D 1 A_CustomPunch(12,0,0,"MKBasicMeleePuff",70)
    Goto CrossPunchA
  MKCrossPunchBerserk:
    ML6F D 1 A_CustomPunch(24,0,0,"MKBasicMeleePuff",70)
    Goto CrossPunchA

// K-K-P-P 64
  64CrossPunch:
    TNT1 A 2 A_PlaySound("*melee")
    ML2F A 0 A_PlaySoundEX("64basicmelee/miss", "SoundSlot5")
    ML6F AB 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"64CrossPunchBerserk")
    ML6F D 1 A_CustomPunch(12,0,0,"64BasicMeleePuff",70)
    Goto CrossPunchA
  64CrossPunchBerserk:
    ML6F D 1 A_CustomPunch(24,0,0,"64BasicMeleePuff",70)
    Goto CrossPunchA

// K-K-P-P END
  CrossPunchA:
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_GiveInventory("MelMachCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML6F C 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML6F B 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML6F A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 3
    Goto AfterMelee
	
// K-K-P-P-P
  CrossDuo:
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 1,"SFCrossDuo") // SF
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 2,"MKCrossDuo") // MK2
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 3,"64CrossDuo") // Smash 64
    TNT1 A 1
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    ML7F AB 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"CrossDuoBerserk")
    ML7F D 1 A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto CrossDuoA
  CrossDuoBerserk:
    ML7F D 1 A_CustomPunch(24,0,0,"BasicMeleePuff",70)
    Goto CrossDuoA

// K-K-P-P-P SF
  SFCrossDuo:
    TNT1 A 1
    ML2F A 0 A_PlaySoundEX("sfbasicmelee/miss", "SoundSlot5")
    ML7F AB 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"SFCrossDuoBerserk")
    ML7F D 1 A_CustomPunch(12,0,0,"SFBasicMeleePuff",70)
    Goto CrossDuoA
  SFCrossDuoBerserk:
    ML7F D 1 A_CustomPunch(24,0,0,"SFBasicMeleePuff",70)
    Goto CrossDuoA

// K-K-P-P-P MK
  MKCrossDuo:
    TNT1 A 1
    ML2F A 0 A_PlaySoundEX("mkbasicmelee/miss", "SoundSlot5")
    ML7F AB 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"mkCrossDuoBerserk")
    ML7F D 1 A_CustomPunch(12,0,0,"MKBasicMeleePuff",70)
    Goto CrossDuoA
  MKCrossDuoBerserk:
    ML7F D 1 A_CustomPunch(24,0,0,"MKBasicMeleePuff",70)
    Goto CrossDuoA
	
// K-K-P-P-P 64
  64CrossDuo:
    TNT1 A 1
    ML2F A 0 A_PlaySoundEX("64basicmelee/miss", "SoundSlot5")
    ML7F AB 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"64CrossDuoBerserk")
    ML7F D 1 A_CustomPunch(12,0,0,"64BasicMeleePuff",70)
    Goto CrossDuoA
  64CrossDuoBerserk:
    ML7F D 1 A_CustomPunch(24,0,0,"64BasicMeleePuff",70)
    Goto CrossDuoA
	
// K-K-P-P-P END
  CrossDuoA:
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_GiveInventory("MelMachCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
	TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML7F C 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML7F B 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML7F A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 3
    Goto AfterMelee
	
// K-K-P-P-P-P DEFAULT
  RapidFireFinish:
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 1,"SFRapidFireFinish") // SF
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 2,"MKRapidFireFinish") // MK2
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 3,"64RapidFireFinish") // Smash 64
    TNT1 A 1 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
    ML8F ABD 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"RapidFireFinishBerserk")
    ML8F E 5 A_CustomPunch(16,0,0,"StrongMeleePuff",90)
    Goto RapidFireFinishA
  RapidFireFinishBerserk:
    ML8F E 5 A_CustomPunch(32,0,0,"StrongMeleePuff",90)
    Goto RapidFireFinishA

// K-K-P-P-P-P SF
  SFRapidFireFinish:
    TNT1 A 1 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("SFstrongmelee/miss", "SoundSlot5")
    ML8F ABD 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"SFRapidFireFinishBerserk")
    ML8F E 5 A_CustomPunch(16,0,0,"SFStrongMeleePuff",90)
    Goto RapidFireFinishA
  SFRapidFireFinishBerserk:
    ML8F E 5 A_CustomPunch(32,0,0,"SFStrongMeleePuff",90)
    Goto RapidFireFinishA

// K-K-P-P-P-P MK
  MKRapidFireFinish:
    TNT1 A 1 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("mkstrongmelee/miss", "SoundSlot5")
    ML8F ABD 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"MKRapidFireFinishBerserk")
    ML8F E 5 A_CustomPunch(16,0,0,"MKStrongMeleePuff",90)
    Goto RapidFireFinishA
  MKRapidFireFinishBerserk:
    ML8F E 5 A_CustomPunch(32,0,0,"MKStrongMeleePuff",90)
    Goto RapidFireFinishA
	
// K-K-P-P-P-P 64
  64RapidFireFinish:
    TNT1 A 1 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("64strongmelee/miss", "SoundSlot5")
    ML8F ABD 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"64RapidFireFinishBerserk")
    ML8F E 5 A_CustomPunch(16,0,0,"64StrongMeleePuff",90)
    Goto RapidFireFinishA
  64RapidFireFinishBerserk:
    ML8F E 5 A_CustomPunch(32,0,0,"64StrongMeleePuff",90)
    Goto RapidFireFinishA
	
// K-K-P-P-P-P END
  RapidFireFinishA:
    ML8F DCBA 1
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_GiveInventory("MelMachCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 AAAAAA 1 A_WeaponReady
    TNT1 A 0 A_TakeInventory("MelAlternateCombo", 99)
    TNT1 A 6
    Goto AfterMelee
	
//Kicks
  AltFire:
    TNT1 A 0 A_JumpIfInventory("MagSlingToken", 1,"MagSling")
    ML1F A 0 A_JumpIfInventory("MelAlternateCombo",4,"StingrayFinisher")
    ML1F A 0 A_JumpIfInventory("MelAlternateCombo",2,"ViperFinisher")
    ML1F A 0 A_JumpIfInventory("MelAlternateCombo",1,"UpperKick")
    ML1F A 0 A_JumpIfInventory("MelPrimaryCombo",3,"AzureKnee")
    ML1F A 0 A_JumpIfInventory("MelPrimaryCombo",2,"StreetSweeperFinisher")
	
// K DEFAULT
  DefaultKick:
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 1,"SFKick") // SF
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 2,"MKKick") // MK2
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 3,"64Kick") // Smash 64
	ML1F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    MK4F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"AltFireBerserk")
    MK4F D 1 A_CustomPunch(12,0,0,"BasicMeleePuff",90)
    Goto AltFireA
  AltFireBerserk:
    MK4F D 1 A_CustomPunch(24,0,0,"BasicMeleePuff",90)
    Goto AltFireA

// K SF
  SFKick:
	ML1F A 0 A_PlaySoundEX("sfbasicmelee/miss", "SoundSlot5")
    MK4F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"SFAltFireBerserk")
    MK4F D 1 A_CustomPunch(12,0,0,"SFBasicMeleePuff",90)
    Goto AltFireA
  SFAltFireBerserk:
    MK4F D 1 A_CustomPunch(24,0,0,"SFBasicMeleePuff",90)
    Goto AltFireA

// K MK
  MKKick:
	ML1F A 0 A_PlaySoundEX("mkbasicmelee/miss", "SoundSlot5")
    MK4F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"MKAltFireBerserk")
    MK4F D 1 A_CustomPunch(12,0,0,"MKBasicMeleePuff",90)
    Goto AltFireA
  MKAltFireBerserk:
    MK4F D 1 A_CustomPunch(24,0,0,"MKBasicMeleePuff",90)
    Goto AltFireA
	
// K 64
  64Kick:
	ML1F A 0 A_PlaySoundEX("64basicmelee/miss", "SoundSlot5")
    MK4F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"64AltFireBerserk")
    MK4F D 1 A_CustomPunch(12,0,0,"64BasicMeleePuff",90)
    Goto AltFireA
  64AltFireBerserk:
    MK4F D 1 A_CustomPunch(24,0,0,"64BasicMeleePuff",90)
    Goto AltFireA
	
// K END
  AltFireA:
    MK4F E 1
    TNT1 A 0 A_GiveInventory("MelAlternateCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    MK4F F 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    MK4F G 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    MK4F H 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    Goto AfterMelee
	
// K-K
  UpperKick:
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 1,"SFUpperKick") // SF
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 2,"MKUpperKick") // MK2
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 3,"64UpperKick") // Smash 64
    TNT1 A 3
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    ML2F A 0 A_PlaySound("*melee")
    MK5F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"UpperKickBerserk")
    MK5F D 2 A_CustomPunch(12,0,0,"BasicMeleePuff",90)
    Goto UpperKickA
  UpperKickBerserk:
    MK5F D 2 A_CustomPunch(24,0,0,"BasicMeleePuff",90)
    Goto UpperKickA

// K-K SF
  SFUpperKick:
    TNT1 A 3
    ML2F A 0 A_PlaySoundEX("sfbasicmelee/miss", "SoundSlot5")
    ML2F A 0 A_PlaySound("*melee")
    MK5F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"SFUpperKickBerserk")
    MK5F D 2 A_CustomPunch(12,0,0,"SFBasicMeleePuff",90)
    Goto UpperKickA
  SFUpperKickBerserk:
    MK5F D 2 A_CustomPunch(24,0,0,"SFBasicMeleePuff",90)
    Goto UpperKickA

// K-K MK
  MKUpperKick:
    TNT1 A 3
    ML2F A 0 A_PlaySoundEX("mkbasicmelee/miss", "SoundSlot5")
    ML2F A 0 A_PlaySound("*melee")
    MK5F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"MKUpperKickBerserk")
    MK5F D 2 A_CustomPunch(12,0,0,"MKBasicMeleePuff",90)
    Goto UpperKickA
  MKUpperKickBerserk:
    MK5F D 2 A_CustomPunch(24,0,0,"MKBasicMeleePuff",90)
    Goto UpperKickA
	
// K-K 64
  64UpperKick:
    TNT1 A 3
    ML2F A 0 A_PlaySoundEX("64basicmelee/miss", "SoundSlot5")
    ML2F A 0 A_PlaySound("*melee")
    MK5F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"64UpperKickBerserk")
    MK5F D 2 A_CustomPunch(12,0,0,"64BasicMeleePuff",90)
    Goto UpperKickA
  64UpperKickBerserk:
    MK5F D 2 A_CustomPunch(24,0,0,"64BasicMeleePuff",90)
    Goto UpperKickA
	
// K-K END
  UpperKickA:
    MK5F E 1
    TNT1 A 0 A_GiveInventory("MelAlternateCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    MK5F F 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 G 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 3
    Goto AfterMelee
	
// K-K-K DEFAULT
  ViperFinisher:
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 1,"SFViperFinisher") // SF
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 2,"MKViperFinisher") // MK2
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 3,"64ViperFinisher") // Smash 64
    TNT1 A 3 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
    MK6F AB 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"ViperFinisherBerserk")
    MK6F C 2 A_CustomPunch(18,0,0,"StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(12,0,0,"BlankMeleePuff",90)
    Goto ViperFinisherA
  ViperFinisherBerserk:
    MK6F C 2 A_CustomPunch(36,0,0,"StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto ViperFinisherA

// K-K-K SF
  SFViperFinisher:
    TNT1 A 3 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("sfstrongmelee/miss", "SoundSlot5")
    MK6F AB 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"SFViperFinisherBerserk")
    MK6F C 2 A_CustomPunch(18,0,0,"SFStrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(12,0,0,"BlankMeleePuff",90)
    Goto ViperFinisherA
  SFViperFinisherBerserk:
    MK6F C 2 A_CustomPunch(36,0,0,"SFStrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto ViperFinisherA

// K-K-K MK
  MKViperFinisher:
    TNT1 A 3 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("mkstrongmelee/miss", "SoundSlot5")
    MK6F AB 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"MKViperFinisherBerserk")
    MK6F C 2 A_CustomPunch(18,0,0,"MKStrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(12,0,0,"BlankMeleePuff",90)
    Goto ViperFinisherA
  MKViperFinisherBerserk:
    MK6F C 2 A_CustomPunch(36,0,0,"MKStrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto ViperFinisherA

// K-K-K 64
  64ViperFinisher:
    TNT1 A 3 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("64strongmelee/miss", "SoundSlot5")
    MK6F AB 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"64ViperFinisherBerserk")
    MK6F C 2 A_CustomPunch(18,0,0,"64StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(12,0,0,"BlankMeleePuff",90)
    Goto ViperFinisherA
  64ViperFinisherBerserk:
    MK6F C 2 A_CustomPunch(36,0,0,"64StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto ViperFinisherA
	
// K-K-K END
  ViperFinisherA:
    MK6F DEF 1
    TNT1 A 6
    Goto AfterMelee
	
// P-P-K DEFAULT
  StreetSweeperFinisher:
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 1,"SFStreetSweeperFinisher") // SF
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 2,"MKStreetSweeperFinisher") // MK2
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 3,"64StreetSweeperFinisher") // Smash 64
    TNT1 A 4 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
    MK1F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"StreetSweeperFinisherBerserk")
    MK1F D 1 A_CustomPunch(18,0,0,"StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    Goto StreetSweeperFinisherA
  StreetSweeperFinisherBerserk:
    MK1F D 1 A_CustomPunch(36,0,0,"StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto StreetSweeperFinisherA

// P-P-K SF
  SFStreetSweeperFinisher:
    TNT1 A 4 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("sfstrongmelee/miss", "SoundSlot5")
    MK1F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"SFStreetSweeperFinisherBerserk")
    MK1F D 1 A_CustomPunch(18,0,0,"SFStrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    Goto StreetSweeperFinisherA
  SFStreetSweeperFinisherBerserk:
    MK1F D 1 A_CustomPunch(36,0,0,"SFStrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto StreetSweeperFinisherA

// P-P-K MK
  MKStreetSweeperFinisher:
    TNT1 A 4 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("mkstrongmelee/miss", "SoundSlot5")
    MK1F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"MKStreetSweeperFinisherBerserk")
    MK1F D 1 A_CustomPunch(18,0,0,"MKStrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    Goto StreetSweeperFinisherA
  MKStreetSweeperFinisherBerserk:
    MK1F D 1 A_CustomPunch(36,0,0,"MKStrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto StreetSweeperFinisherA

// P-P-K 64
  64StreetSweeperFinisher:
    TNT1 A 4 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("64strongmelee/miss", "SoundSlot5")
    MK1F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"64StreetSweeperFinisherBerserk")
    MK1F D 1 A_CustomPunch(18,0,0,"64StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    Goto StreetSweeperFinisherA
  64StreetSweeperFinisherBerserk:
    MK1F D 1 A_CustomPunch(36,0,0,"64StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto StreetSweeperFinisherA

// P-P-K END
  StreetSweeperFinisherA:
    MK1F EFGHI 1
    TNT1 A 5
    Goto AfterMelee

// P-P-P-K DEFAULT
  AzureKnee:
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 1,"SFAzureKnee") // SF
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 2,"MKAzureKnee") // MK2
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 3,"64AzureKnee") // Smash 64
    TNT1 A 2
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    MK2F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"AzureKneeBerserk")
    MK2F D 3 A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto AzureKneeA
  AzureKneeBerserk:
    MK2F D 3 A_CustomPunch(24,0,0,"BasicMeleePuff",70)
    Goto AzureKneeA

// P-P-P-K SF
  SFAzureKnee:
    TNT1 A 2
    ML2F A 0 A_PlaySoundEX("sfbasicmelee/miss", "SoundSlot5")
    MK2F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"SFAzureKneeBerserk")
    MK2F D 3 A_CustomPunch(12,0,0,"SFBasicMeleePuff",70)
    Goto AzureKneeA
  SFAzureKneeBerserk:
    MK2F D 3 A_CustomPunch(24,0,0,"SFBasicMeleePuff",70)
    Goto AzureKneeA

// P-P-P-K MK
  MKAzureKnee:
    TNT1 A 2
    ML2F A 0 A_PlaySoundEX("mkbasicmelee/miss", "SoundSlot5")
    MK2F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"MKAzureKneeBerserk")
    MK2F D 3 A_CustomPunch(12,0,0,"MkBasicMeleePuff",70)
    Goto AzureKneeA
  MKAzureKneeBerserk:
    MK2F D 3 A_CustomPunch(24,0,0,"MKBasicMeleePuff",70)
    Goto AzureKneeA

// P-P-P-K 64
  64AzureKnee:
    TNT1 A 2
    ML2F A 0 A_PlaySoundEX("64basicmelee/miss", "SoundSlot5")
    MK2F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"64AzureKneeBerserk")
    MK2F D 3 A_CustomPunch(12,0,0,"64BasicMeleePuff",70)
    Goto AzureKneeA
  64AzureKneeBerserk:
    MK2F D 3 A_CustomPunch(24,0,0,"64BasicMeleePuff",70)
    Goto AzureKneeA

// P-P-P-K END
  AzureKneeA:
    MK2F CB 1
    TNT1 A 0 A_GiveInventory("MelAlternateCombo", 4)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    MK2F A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 6
    Goto AfterMelee

// P-P-P-K-K DEFAULT
  StingRayFinisher:
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 1,"SFStingRayFinisher") // SF
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 2,"MKStingRayFinisher") // MK2
	TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("GetMeleeSoundsCVAR") == 3,"64StingRayFinisher") // Smash 64
    TNT1 A 3 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
    MK3F ABCD 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"StingRayFinisherBerserk")
    MK3F E 1 A_CustomPunch(18,0,0,"StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    Goto StingRayFinisherA
  StingRayFinisherBerserk:
    MK3F E 1 A_CustomPunch(36,0,0,"StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto StingRayFinisherA

// P-P-P-K-K SF
  SFStingRayFinisher:
    TNT1 A 3 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("sfstrongmelee/miss", "SoundSlot5")
    MK3F ABCD 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"SFStingRayFinisherBerserk")
    MK3F E 1 A_CustomPunch(18,0,0,"SFStrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    Goto StingRayFinisherA
  SFStingRayFinisherBerserk:
    MK3F E 1 A_CustomPunch(36,0,0,"SFStrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto StingRayFinisherA

// P-P-P-K-K MK
  MKStingRayFinisher:
    TNT1 A 3 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("mkstrongmelee/miss", "SoundSlot5")
    MK3F ABCD 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"MKStingRayFinisherBerserk")
    MK3F E 1 A_CustomPunch(18,0,0,"MKStrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    Goto StingRayFinisherA
  MKStingRayFinisherBerserk:
    MK3F E 1 A_CustomPunch(36,0,0,"MKStrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto StingRayFinisherA
	
// P-P-P-K-K 64
  64StingRayFinisher:
    TNT1 A 3 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("64strongmelee/miss", "SoundSlot5")
    MK3F ABCD 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"64StingRayFinisherBerserk")
    MK3F E 1 A_CustomPunch(18,0,0,"64StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    Goto StingRayFinisherA
  64StingRayFinisherBerserk:
    MK3F E 1 A_CustomPunch(36,0,0,"64StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto StingRayFinisherA

// P-P-P-K-K END
  StingRayFinisherA:
    MK3F FGHI 1
    TNT1 A 0 A_GiveInventory("MelPistolCombo", 1)//allows you to do the pistol combo
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_TakeInventory("MelAlternateCombo", 99)
    TNT1 A 0 A_TakeInventory("MelMachCombo", 99)
    TNT1 A 5 A_WeaponReady
    Goto AfterMelee

// MELEE COOLDOWN
  AfterMelee:
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_TakeInventory("MelAlternateCombo", 99)
    TNT1 A 0 A_TakeInventory("MelMachCombo", 99)
    TNT1 A 0 A_TakeInventory("MelPistolCombo", 99)
    TNT1 A 0 A_TakeInventory("MagPushToken", 99)
    TNT1 A 0 A_TakeInventory("MagSlingToken", 99)
    TNT1 A 0 A_TakeInventory("ChargedAttack", 99)
    TNT1 A 0 A_TakeInventory("ComboCoolDown", 99)
    MLED EDCBA 1
    MLEG A 1
    Goto Ready

  SPTraitStart:
    MLED ABCDE 1 
	Goto SPTrait
  }
}


ACTOR ChargedAttack: Inventory
{
  Inventory.MaxAmount 99
  Inventory.Icon TNT1A0
}
