//===========================================================================
//
// Mel's Melee Style
//
// by Cardboard Marty
// Sprites by Cardboard Marty
// Bases by Blox, Scuba Steve, Banjo Entertainment, PrettyFist
// 
//
//===========================================================================

ACTOR MelMelee : TSPMelBaseWeapon
{
  Inventory.PickupMessage "You relearned your fighting style you apparently dropped [Class: Melee, Slot 1]"
  Obituary "%o learned why %k is the king of the iron fist."
  Weapon.Kickback 100
  Weapon.BobStyle Alpha
  Weapon.BobSpeed 1.5
  Weapon.BobRangeY 1.0
  Weapon.BobRangeX 0.5
  Tag "$MelMeleeTag"
  +WEAPON.WIMPY_WEAPON
  +WEAPON.MELEEWEAPON
  +WEAPON.NOALERT
  +WEAPON.NOAUTOAIM
  +WEAPON.NOAUTOFIRE
  +NOEXTREMEDEATH
  +INVENTORY.UNDROPPABLE
  States
  {
  Spawn:
    TNT1 A -1
    Loop
  Deselect:
    TNT1 A 0 A_TakeInventory("MelIdle", 99999)
    TNT1 A 0 A_TakeInventory("MeleeSelected", 1)
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_TakeInventory("MelAlternateCombo", 99)
    TNT1 A 0 A_TakeInventory("MelMachCombo", 99)
    TNT1 A 0 A_JumpIfInventory("ComboCoolDown", 1, "ComboDeselect")
    TNT1 A 0 A_JumpIfInventory("MelPistolCombo", 1, "ComboDeselect")
    TNT1 A 0 A_TakeInventory("ComboCoolDown", 99)
    TNT1 A 0 A_TakeInventory("MelPistolCombo", 99)
    111D ABC 1
    TNT1 A 3
  DeselectLoop:
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAA 0  A_Lower
    TNT1 A 1 A_Lower
    Loop
  Select:
    TNT1 A 0 A_GiveInventory("MeleeSelected", 1)
    TNT1 A 0 A_WeaponOffset(0,32)
    111U ABC 1
    111G A 1 A_Raise
    Loop
  Ready:
	TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTraitStart")
    TNT1 A 0 A_JumpIfInventory("MelIdle", 1575, "Idle")
	TNT1 A 0 A_GiveInventory("MelIdle", 1)
    111G A 1 A_WeaponReady
    Loop
   
   Idle:
    TNT1 A 0 A_TakeInventory("MelIdle", 99999)
   Idle1:
	TNT1 A 0 A_PlaySound("meltemp", 5)
	111V ABCDEE 1 A_WeaponReady
	TNT1 A 0 A_PlaySound("melidle", 6)
	TNT1 A 0 A_SetBlend("39 99 0", 0.4, 50)
	111V F 5 A_WeaponReady
	TNT1 A 0 A_Quake(1,40,0,5,"")
	111V GHIFGHIFGHIFGHIFGHIFGHIFGHIFGHIFGHI 1 A_WeaponReady
	TNT1 A 0 A_SetBlend("39 99 0", 0.01, 2)
	111V FEEDDCBA 1 A_WeaponReady
	Goto Ready
	
//Punch!
  Fire:
    TNT1 A 0 A_TakeInventory("MelIdle", 99999)
    TNT1 A 0 A_JumpIfInventory("MagPushToken", 1,"MagPush")
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 0 A_JumpIfInventory("MelMachCombo",6,"AfterMelee") //made so you can't Melbow again after the Rapid Fire Finish
    TNT1 A 0 A_JumpIfInventory("MelMachCombo",5,"RapidFireFinish")
    TNT1 A 0 A_JumpIfInventory("MelMachCombo",4,"CrossDuo")
    TNT1 A 0 A_JumpIfInventory("MelMachCombo",3,"CrossPunch")
    TNT1 A 0 A_JumpIfInventory("MelMachCombo",2,"CrossDuo")
    TNT1 A 0 A_JumpIfInventory("MelMachCombo",1,"CrossPunch")
    TNT1 A 0 A_JumpIfInventory("MelAlternateCombo",2,"Melbow")
    TNT1 A 0 A_JumpIfInventory("MelPrimaryCombo",3,"VenomFinisher")
    TNT1 A 0 A_JumpIfInventory("MelPrimaryCombo",2,"LeftOverhead")
    TNT1 A 0 A_JumpIfInventory("MelPrimaryCombo",1,"RightHook")
	
  // P DEFAULT
  DefaultPunch:
	TNT1 A 0 A_PlaySound("*smallmelee")
	TNT1 A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    1111 ABCD 1
    1111 E 1 A_TSP_Melee(10,70,"BasicMeleePuff")//A_CustomPunch(10,0,0,"BasicMeleePuff",70)
    Goto ComboP1

	
  // P END
  ComboP1:
    TNT1 A 0 A_GiveInventory("MelPrimaryCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    1111 F 2 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    1111 G 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    1111 H 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
	TNT1 A 0 A_Refire("ChargeUppercut")
 ComboP1Ender: //You'll return to this state if you don't continue with the uppercut!
    TNT1 A 0 ACS_NamedExecute("PlayerSpeed",0,100,0,0)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
	TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    Goto AfterMelee
	
// DEFAULT P-P
  RightHook:
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    ML2F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"RightHookBerserk")
    ML2F D 1 A_TSP_Melee(12,70,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto RightHookA
  RightHookBerserk:
    ML2F D 1 A_CustomPunch(24,0,0,"BasicMeleePuff",70)
    Goto RightHookA

// P-P END
  RightHookA:
    ML2F E 1
    TNT1 A 0 A_GiveInventory("MelPrimaryCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML2F H 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    Goto AfterMelee
	
//P-P-P DEFAULT
  LeftOverhead:
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot6")
    ML2F A 0 A_PlaySound("*mediummelee")
    ML3F ABC 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"LeftOverheadBerserk")
    ML3F E 1 A_TSP_Melee(12,70,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto LeftOverheadA

// P-P-P END
  LeftOverheadA:
    ML3F F 1
    TNT1 A 0 A_GiveInventory("MelPrimaryCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
	//TNT1 GJAAAAAAAAA 1 A_TSP_HoldForCombo("VenomFinisher","SuperUpperCut","AzureKnee","AzureKnee")
	
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 G 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 J 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 3
    Goto AfterMelee
	
// P-P-P-P DEFAULT
	VenomFinisher:
		TNT1 A 6 A_PlaySound("*largemelee")
		TNT1 A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
		111T ABC 1
		111T D 7 A_TSP_Melee(26,90,"UppercutMeleePuff",0,8,16,45,45)//A_CustomPunch(14,0,0,"UppercutMeleePuff",90)
		// [Py] replace later
		/*ML4F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
		ML4F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
		ML4F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
		ML4F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)*/
		Goto VenomFinisherA

// P-P-P-P END
	VenomFinisherA:
		111T EFGH 1
		TNT1 A 8
		Goto AfterMelee
	

// Charge Uppercut (After ComboP1)
	ChargeUppercut:
		TNT1 A 1 A_PlaySound("magpunch/charge", 5)
		TNT1 A 1 A_Quake(3,2,0,5,"")
		TNT1 A 0 ACS_NamedExecute("PlayerSpeed",0,50,0,0)
		TNT1 A 0 A_SetBlend("39 99 0", 0.4, 10)
	ChargeLvl1:
		TNT1 A 0 A_JumpIfInventory("ChargedAttack", 9, "ChargeComplete")
	    TNT1 A 3 A_GiveInventory("ChargedAttack", 1)
		TNT1 A 1 A_Quake(1,2,0,5,"")
		TNT1 A 0 A_SetBlend("39 99 0", 0.05, 3)
		TNT1 A 0 A_Refire("ChargeLvl1")
		Goto ComboP1Ender
	ChargeComplete:
		TNT1 A 0 A_ZoomFactor(1.05)
		TNT1 A 0 A_SetBlend("39 99 0", 0.4, 15)
		TNT1 A 4 A_PlaySound("magpunch/chargefin", 6)
		TNT1 A 1 A_Quake(10,5,0,5,"")
		TNT1 A 0 A_ZoomFactor(1.0)
		TNT1 A 0 A_Refire("ChargeHold")
		Goto SuperUppercut
	ChargeHold:
		TNT1 A 1 A_Quake(1,2,0,5,"")
		TNT1 A 0 A_SetBlend("39 99 0", 0.05, 3)
		TNT1 A 0 A_Refire("ChargeHold")
	SuperUppercut:
		TNT1 A 0 ACS_NamedExecute("PlayerSpeed",0,100,0,0)
		TNT1 A 0 A_JumpIf (momZ > 0, "SuperUppercutAir")
        TNT1 A 0 A_JumpIf (momZ < 0, "SuperUppercutAir")
	    TNT1 A 0 A_Recoil(-10)
		TNT1 A 8 A_PlaySound("*xlmelee", 5)
		TNT1 A 0 A_PlaySoundEX("magpunch/miss", "SoundSlot6")
	    TNT1 A 0 ThrustThingZ(0,53,0,1)
		TNT1 A 0 A_SetBlend("39 99 0", 0.2, 5)
		110D ABC 1 BRIGHT
		110D D 1 BRIGHT A_TSP_Melee(20,90,"MagDivePuff",0,8,16,45,45,TSPM_SUPERFREEZE)
	    TNT1 A 0 ThrustThingZ(0,6,0,1)
		TNT1 A 0 A_SetPitch(pitch - 3)
	    110D E 2 BRIGHT ThrustThingZ(0,1,0,1)
	    110D F 1 BRIGHT ThrustThingZ(0,1,0,1)
	    110D G 1 BRIGHT ThrustThingZ(0,1,0,1)
	    110D H 1 ThrustThingZ(0,1,0,1)
		Goto FloatyBoy
	SuperUppercutAir: //When in air, the uppercut doesn't carry you upwards that much
	    TNT1 A 0 A_Recoil(-5)
		TNT1 A 8 A_PlaySound("*xlmelee", 5)
		TNT1 A 0 A_PlaySoundEX("magpunch/miss", "SoundSlot6")
	    TNT1 A 0 ThrustThingZ(0,25,0,1)
		TNT1 A 0 A_SetBlend("39 99 0", 0.2, 5)
		110D ABC 1 BRIGHT
		110D D 1 BRIGHT A_TSP_Melee(20,90,"MagDivePuff",0,8,16,45,45,TSPM_SUPERFREEZE)
	    TNT1 A 0 ThrustThingZ(0,6,0,1)
		TNT1 A 0 A_SetPitch(pitch - 3)
	    110D E 2 BRIGHT ThrustThingZ(0,1,0,1)
	    110D F 1 BRIGHT ThrustThingZ(0,1,0,1)
	    110D G 1 BRIGHT ThrustThingZ(0,1,0,1)
	    110D H 1 ThrustThingZ(0,1,0,1)
		Goto FloatyBoy
	FloatyBoy:
		110D I 1 ThrustThingZ(0,1,0,1)
		110D C 1 ThrustThingZ(0,1,0,1)
		110D B 1 ThrustThingZ(0,1,0,1)
		110D A 1 ThrustThingZ(0,1,0,1)
		TNT1 A 1 ThrustThingZ(0,1,0,1)
		TNT1 A 1 ThrustThingZ(0,1,0,1)
        TNT1 A 1 ThrustThingZ(0,1,0,1)
		TNT1 A 1 ThrustThingZ(0,1,0,1)
        TNT1 A 1 ThrustThingZ(0,1,0,1)
		TNT1 A 1 ThrustThingZ(0,1,0,1)
        TNT1 A 1 ThrustThingZ(0,1,0,1)
		TNT1 A 1 ThrustThingZ(0,1,0,1)
		TNT1 A 1 ThrustThingZ(0,1,0,1)
		TNT1 A 1 ThrustThingZ(0,1,0,1)
		Goto AfterMelee

// K-K-P DEFAULT
  Melbow:
	TNT1 A 0 A_PlaySound("*mediummelee")
    TNT1 A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
    111S ABC 1
    111S D 1 A_TSP_Melee(20,70,"BasicMeleePuff")
	Goto MelbowA

// K-K-P END
  MelbowA:
    111S EEEF 1
    TNT1 A 0 A_GiveInventory("MelMachCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    111S G 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    111S H 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    111S I 1 A_WeaponReady
	/*TNT1 A 0 A_Refire("OneInchFist")
  MelbowEnder:
	TNT1 A 0 ACS_NamedExecute("PlayerSpeed",0,100,0,0)*/
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 5
    Goto AfterMelee
	
// K-K-P-P DEFAULT
  CrossPunch:
    TNT1 A 2 A_PlaySound("*smallmelee")
    TNT1 A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    111O AB 1 
    111O C 1 A_TSP_Melee(12,70,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto CrossPunchA

// K-K-P-P END
  CrossPunchA:
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_GiveInventory("MelMachCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    111O C 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    111O B 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    111O A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 3
    Goto AfterMelee
	
// K-K-P-P-P
  CrossDuo:
    TNT1 A 1 A_PlaySound("*smallmelee")
    TNT1 A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    111P AB 1
    111P C 1 A_TSP_Melee(12,70,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto CrossDuoA
	
// K-K-P-P-P END
  CrossDuoA:
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_GiveInventory("MelMachCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
	TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    111P C 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    111P B 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    111P A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 3
    Goto AfterMelee
	
// K-K-P-P-P-P DEFAULT
  RapidFireFinish:
    TNT1 A 2 A_PlaySound("*largemelee")
    TNT1 A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
	TNT1 A 0 A_Recoil(-3)
    111Q ABC 1 
    111Q D 11 A_TSP_Melee(22,90,"StrongMeleePuff")//A_CustomPunch(16,0,0,"StrongMeleePuff",90)
    Goto RapidFireFinishA
	
// K-K-P-P-P-P END
  RapidFireFinishA:
    111Q EFG 1
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_GiveInventory("MelMachCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 AAAAAA 1 A_WeaponReady
    TNT1 A 0 A_TakeInventory("MelAlternateCombo", 99)
    TNT1 A 6
    Goto AfterMelee

// One-Inch Fist (After Melbow) - This attack is dummied out as of 7/17/2019
/*	OneInchFist:
		TNT1 A 1 A_PlaySound("magpunch/charge", 6)
		TNT1 A 1 A_Quake(3,2,0,5,"")
		TNT1 A 0 ACS_NamedExecute("PlayerSpeed",0,50,0,0)
		TNT1 A 0 A_SetBlend("39 99 0", 0.4, 10)
	OIFChargeLvl1:
		TNT1 A 0 A_JumpIfInventory("ChargedAttack", 20, "OIFChargeComplete")
	    TNT1 A 3 A_GiveInventory("ChargedAttack", 1)
		TNT1 A 1 A_Quake(1,2,0,5,"")
		TNT1 A 0 A_SetBlend("39 99 0", 0.05, 3)
		TNT1 A 0 A_Refire("OIFChargeLvl1")
		Goto MelbowEnder
	OIFChargeComplete:
		TNT1 A 0 A_ZoomFactor(1.05)
		TNT1 A 0 A_SetBlend("39 99 0", 0.4, 15)
		TNT1 A 4 A_PlaySound("magpunch/chargefin", 6)
		TNT1 A 1 A_Quake(10,5,0,5,"")
		TNT1 A 0 A_ZoomFactor(1.0)
		TNT1 A 0 A_Refire("OIFChargeHold")
		Goto OneInchFistLaunch
	OIFChargeHold:
		TNT1 A 1 A_Quake(1,2,0,5,"")
		TNT1 A 0 A_SetBlend("39 99 0", 0.05, 3)
		TNT1 A 0 A_Refire("OIFChargeHold")
	OneInchFistLaunch:
		TNT1 A 0 ACS_NamedExecute("PlayerSpeed",0,100,0,0)
	    TNT1 A 0 A_Recoil(-5)
		TNT1 A 5 A_PlaySound("*xlmelee", 5)
		TNT1 A 0 A_PlaySoundEX("magpunch/miss", "SoundSlot6")
		1111 ABCD 1
		TNT1 A 0 A_Quake(2,3,0,5,"")
		1111 E 12 A_TSP_Melee(150,90,"MagDivePuff",0,30,3)
		1111 EEEEFGH 1
		TNT1 AAAAAA 1
		Goto AfterMelee*/
		
//Kicks
  AltFire:
    TNT1 A 0 A_JumpIfInventory("MagSlingToken", 1,"MagSling")
    TNT1 A 0 A_JumpIfInventory("MelAlternateCombo",4,"CrescentFangFinisher")
    TNT1 A 0 A_JumpIfInventory("MelAlternateCombo",2,"ViperFinisher")
    TNT1 A 0 A_JumpIfInventory("MelAlternateCombo",1,"UpperKick")
    TNT1 A 0 A_JumpIfInventory("MelPrimaryCombo",3,"AzureKnee")
    TNT1 A 0 A_JumpIfInventory("MelPrimaryCombo",2,"StreetSweeperFinisher")
	
// K DEFAULT
  DefaultKick:
	TNT1 A 0 A_PlaySound("*smallmelee")
	TNT1 A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    111K ABC 1
    111K D 1 A_TSP_Melee(12,90,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",90)
    Goto AltFireA
	
// K END
  AltFireA:
    111K E 1
    TNT1 A 0 A_GiveInventory("MelAlternateCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    111K F 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    111K G 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 0 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    Goto AfterMelee
	
// K-K
  UpperKick:
    TNT1 A 2
    TNT1 A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    TNT1 A 0 A_PlaySound("*mediummelee")
    111L ABC 1
    111L D 2 A_TSP_Melee(12,90,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",90)
    Goto UpperKickA
	
// K-K END
  UpperKickA:
    111L E 1
    TNT1 A 0 A_GiveInventory("MelAlternateCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    111L F 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 3
    Goto AfterMelee
	
// K-K-K DEFAULT
  ViperFinisher:
    TNT1 A 5 A_PlaySound("*largemelee")
	TNT1 A 0 Thrustthing(angle*256/360,9, 0, 0)
    TNT1 A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
	TNT1 A 0 A_SetPitch(pitch - 0.5)
	TNT1 A 0 A_SetAngle(angle + (frandom(-0.3,0.3)))
    111R ABC 1
    111R D 3 A_TSP_Melee(18+2+2+12,90,"StrongMeleePuff",0,16,8)//A_CustomPunch(18,0,0,"StrongMeleePuff",90)
    Goto ViperFinisherA
	
// K-K-K END
  ViperFinisherA:
    111R EFG 1
    TNT1 A 7
    Goto AfterMelee
	
// P-P-K DEFAULT
  StreetSweeperFinisher:
    TNT1 A 5 A_PlaySound("*largemelee")
    TNT1 A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
    111J ABC 1
    111J D 0 A_JumpIfInventory("PowerStrength",1,"StreetSweeperFinisherBerserk")
    111J D 1 A_TSP_Melee(18+2+2+2,90,"StrongMeleePuff")//A_CustomPunch(18,0,0,"StrongMeleePuff",90)
    //TNT1 A 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    //TNT1 A 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    //TNT1 A 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    Goto StreetSweeperFinisherA

// P-P-K END
  StreetSweeperFinisherA:
    111J EFGH 1
    TNT1 A 5
    Goto AfterMelee

// P-P-P-K DEFAULT
  AzureKnee:
    TNT1 A 2
    TNT1 A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
	TNT1 A 0 A_Recoil(-5)
    111N ABC 1
    111N D 4 A_TSP_Melee(16,70,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto AzureKneeA

// P-P-P-K END
  AzureKneeA:
    111N CB 1
    TNT1 A 0 A_GiveInventory("MelAlternateCombo", 4)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    111N A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 6
    Goto AfterMelee

// P-P-P-K-K DEFAULT
  CrescentFangFinisher:
    TNT1 A 6 A_PlaySound("*largemelee")
    TNT1 A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
    111M ABCDE 1
    111M F 1 A_TSP_Melee(30+2+2+2,90,"StrongMeleePuff",10,0)/*A_CustomPunch(18,0,0,"StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)*/
    Goto CrescentFangFinisherA

// P-P-P-K-K END
  CrescentFangFinisherA:
    111M GH 1
	TNT1 A 10
    TNT1 A 0 A_GiveInventory("MelPistolCombo", 1)//allows you to do the pistol combo
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_TakeInventory("MelAlternateCombo", 99)
    TNT1 A 0 A_TakeInventory("MelMachCombo", 99)
    Goto AfterMelee

// MELEE COOLDOWN
  AfterMelee:
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_TakeInventory("MelAlternateCombo", 99)
    TNT1 A 0 A_TakeInventory("MelMachCombo", 99)
    TNT1 A 0 A_TakeInventory("MelPistolCombo", 99)
    TNT1 A 0 A_TakeInventory("MagPushToken", 99)
    TNT1 A 0 A_TakeInventory("MagSlingToken", 99)
    TNT1 A 0 A_TakeInventory("ChargedAttack", 99)
    TNT1 A 0 A_TakeInventory("ComboCoolDown", 99)
    111U ABC 1
    111G A 1
    Goto Ready

  SPTraitStart:
    111U CBA 1 
	Goto SPTrait
  }
}


ACTOR ChargedAttack: Inventory
{
  Inventory.MaxAmount 99
  Inventory.Icon TNT1A0
}