//===========================================================================
//
// Mel's Melee Style
//
// by Cardboard Marty
// Sprites by Cardboard Marty, Blox, Scuba Steve, Banjo Entertainment
// 
//
//===========================================================================

ACTOR MelMelee : TSPMelBaseWeapon
{
  Inventory.PickupMessage "You relearned your fighting style you apparently dropped [Class: Melee, Slot 1]"
  Obituary "%o learned why %k is the king of the iron fist."
  Weapon.Kickback 100
  Weapon.BobStyle Alpha
  Weapon.BobSpeed 1.5
  Weapon.BobRangeY 1.0
  Weapon.BobRangeX 0.5
  Tag "$MelMeleeTag"
  +WEAPON.WIMPY_WEAPON
  +WEAPON.MELEEWEAPON
  +WEAPON.NOALERT
  +WEAPON.NOAUTOAIM
  +WEAPON.NOAUTOFIRE
  +NOEXTREMEDEATH
  +INVENTORY.UNDROPPABLE
  States
  {
  Spawn:
    TNT1 A -1
    Loop
  Deselect:
    TNT1 A 0 A_TakeInventory("MeleeSelected", 1)
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_TakeInventory("MelAlternateCombo", 99)
    TNT1 A 0 A_TakeInventory("MelMachCombo", 99)
    TNT1 A 0 A_JumpIfInventory("ComboCoolDown", 1, "ComboDeselect")
    TNT1 A 0 A_JumpIfInventory("MelPistolCombo", 1, "ComboDeselect")
    TNT1 A 0 A_TakeInventory("ComboCoolDown", 99)
    TNT1 A 0 A_TakeInventory("MelPistolCombo", 99)
    111D ABC 1
    TNT1 A 3
  DeselectLoop:
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAA 0  A_Lower
    TNT1 A 1 A_Lower
    Loop
  Select:
    TNT1 A 0 A_GiveInventory("MeleeSelected", 1)
    TNT1 A 4 SetPlayerProperty(0,1,2)
    111U ABC 1
  SelectLoop:
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAA 0  A_Raise
    111G A 1 A_Raise
    Loop
  Ready:
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTraitStart")
    111G A 1 A_WeaponReady
    Loop
	
//Punch!
  Fire:
    TNT1 A 0 A_JumpIfInventory("MagPushToken", 1,"MagPush")
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 0 A_JumpIfInventory("MelMachCombo",4,"AfterMelee") //made so you can't knifehand again after the Rapid Fire Finish
    TNT1 A 0 A_JumpIfInventory("MelMachCombo",3,"RapidFireFinish")
    TNT1 A 0 A_JumpIfInventory("MelMachCombo",2,"CrossDuo")
    TNT1 A 0 A_JumpIfInventory("MelMachCombo",1,"CrossPunch")
    TNT1 A 0 A_JumpIfInventory("MelAlternateCombo",2,"KnifeHand")
    TNT1 A 0 A_JumpIfInventory("MelPrimaryCombo",3,"ScorpionTailFinisher")
    TNT1 A 0 A_JumpIfInventory("MelPrimaryCombo",2,"LeftOverhead")
    TNT1 A 0 A_JumpIfInventory("MelPrimaryCombo",1,"RightHook")
	
  // P DEFAULT
  DefaultPunch:
	TNT1 A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    1111 ABCD 1
    1111 E 1 A_TSP_Melee(10,70,"BasicMeleePuff")//A_CustomPunch(10,0,0,"BasicMeleePuff",70)
    Goto ComboP1

	
  // P END
  ComboP1:
    TNT1 A 0 A_GiveInventory("MelPrimaryCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    1111 F 2 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    1111 G 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    1111 J 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    1111 K 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
	TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    Goto AfterMelee
	
// DEFAULT P-P
  RightHook:
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    ML2F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"RightHookBerserk")
    ML2F D 1 A_TSP_Melee(12,70,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto RightHookA
  RightHookBerserk:
    ML2F D 1 A_CustomPunch(24,0,0,"BasicMeleePuff",70)
    Goto RightHookA

// P-P END
  RightHookA:
    ML2F E 1
    TNT1 A 0 A_GiveInventory("MelPrimaryCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML2F H 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    Goto AfterMelee
	
//P-P-P DEFAULT
  LeftOverhead:
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot6")
    ML2F A 0 A_PlaySound("*melee")
    ML3F ABC 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"LeftOverheadBerserk")
    ML3F E 1 A_TSP_Melee(12,70,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto LeftOverheadA

// P-P-P END
  LeftOverheadA:
    ML3F F 1
    TNT1 A 0 A_GiveInventory("MelPrimaryCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
	TNT1 GJAAAAAAAAA 1 A_TSP_HoldForCombo("ScorpionTailFinisher","SuperUpperCut")
	/*
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 G 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 J 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady*/
    TNT1 A 3
    Goto AfterMelee
	
// P-P-P-P DEFAULT
	ScorpionTailFinisher:
		TNT1 A 5 A_PlaySound("*strongmelee")
		ML2F A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
		ML4F ABC 1
		ML4F D 1 A_TSP_Melee(14,90,"UppercutMeleePuff",0,8,16,45,45)//A_CustomPunch(14,0,0,"UppercutMeleePuff",90)
		// [Py] replace later
		/*ML4F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
		ML4F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
		ML4F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
		ML4F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)*/
		Goto ScorpionTailFinisherA
	SuperUpperCut:
		TNT1 A 5 A_PlaySound("*strongmelee")
		ML2F A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
		ML4F ABC 1
		"----" A 0 A_SetBlend("39 99 0", 0.4, 15)
		ML4F D 1 A_TSP_Melee(14,90,"UppercutMeleePuff",0,8,16,45,45,TSPM_SUPERFREEZE)
		ML4F DDDD 1 A_WeaponOffset(frandom(-2,2),frandom(-2,2))
		ML4F D 0 A_WeaponOffset(0,32)
		Goto ScorpionTailFinisherA

// P-P-P-P END
  ScorpionTailFinisherA:
    ML4F E 2
    ML4F DCBA 1
    TNT1 A 8
    Goto AfterMelee
	
// K-K-P DEFAULT
  KnifeHand:
    ML2F A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
    ML5F ABC 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"KnifeHandBerserk")
    ML5F D 1 A_CustomPunch(14,0,0,"StrongMeleePuff",70)
	Goto KnifeHandA

// K-K-P END
  KnifeHandA:
    ML5F EFG 1
    TNT1 A 0 A_GiveInventory("MelMachCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML5F H 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML5F I 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 5
    Goto AfterMelee
	
// K-K-P-P DEFAULT
  CrossPunch:
    TNT1 A 2 A_PlaySound("*melee")
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    ML6F AB 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"CrossPunchBerserk")
    ML6F D 1 A_TSP_Melee(12,70,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto CrossPunchA
  CrossPunchBerserk:
    ML6F D 1 A_CustomPunch(24,0,0,"BasicMeleePuff",70)
    Goto CrossPunchA

// K-K-P-P END
  CrossPunchA:
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_GiveInventory("MelMachCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML6F C 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML6F B 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML6F A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 3
    Goto AfterMelee
	
// K-K-P-P-P
  CrossDuo:
    TNT1 A 1
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    ML7F AB 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"CrossDuoBerserk")
    ML7F D 1 A_TSP_Melee(12,70,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto CrossDuoA
  CrossDuoBerserk:
    ML7F D 1 A_CustomPunch(24,0,0,"BasicMeleePuff",70)
    Goto CrossDuoA
	
// K-K-P-P-P END
  CrossDuoA:
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_GiveInventory("MelMachCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
	TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML7F C 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML7F B 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    ML7F A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 3
    Goto AfterMelee
	
// K-K-P-P-P-P DEFAULT
  RapidFireFinish:
    TNT1 A 1 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
    ML8F ABD 1 
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"RapidFireFinishBerserk")
    ML8F E 5 A_TSP_Melee(16,90,"StrongMeleePuff")//A_CustomPunch(16,0,0,"StrongMeleePuff",90)
    Goto RapidFireFinishA
  RapidFireFinishBerserk:
    ML8F E 5 A_CustomPunch(32,0,0,"StrongMeleePuff",90)
    Goto RapidFireFinishA
	
// K-K-P-P-P-P END
  RapidFireFinishA:
    ML8F DCBA 1
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_GiveInventory("MelMachCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 AAAAAA 1 A_WeaponReady
    TNT1 A 0 A_TakeInventory("MelAlternateCombo", 99)
    TNT1 A 6
    Goto AfterMelee
	
//Kicks
  AltFire:
    TNT1 A 0 A_JumpIfInventory("MagSlingToken", 1,"MagSling")
    ML1F A 0 A_JumpIfInventory("MelAlternateCombo",4,"StingrayFinisher")
    ML1F A 0 A_JumpIfInventory("MelAlternateCombo",2,"ViperFinisher")
    ML1F A 0 A_JumpIfInventory("MelAlternateCombo",1,"UpperKick")
    ML1F A 0 A_JumpIfInventory("MelPrimaryCombo",3,"AzureKnee")
    ML1F A 0 A_JumpIfInventory("MelPrimaryCombo",2,"StreetSweeperFinisher")
	
// K DEFAULT
  DefaultKick:
	ML1F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    MK4F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"AltFireBerserk")
    MK4F D 1 A_TSP_Melee(12,90,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",90)
    Goto AltFireA
  AltFireBerserk:
    MK4F D 1 A_CustomPunch(24,0,0,"BasicMeleePuff",90)
    Goto AltFireA
	
// K END
  AltFireA:
    MK4F E 1
    TNT1 A 0 A_GiveInventory("MelAlternateCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    MK4F F 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    MK4F G 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    MK4F H 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    Goto AfterMelee
	
// K-K
  UpperKick:
    TNT1 A 3
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    ML2F A 0 A_PlaySound("*melee")
    MK5F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"UpperKickBerserk")
    MK5F D 2 A_TSP_Melee(12,90,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",90)
    Goto UpperKickA
  UpperKickBerserk:
    MK5F D 2 A_CustomPunch(24,0,0,"BasicMeleePuff",90)
    Goto UpperKickA
	
// K-K END
  UpperKickA:
    MK5F E 1
    TNT1 A 0 A_GiveInventory("MelAlternateCombo", 1)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    MK5F F 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 G 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 3
    Goto AfterMelee
	
// K-K-K DEFAULT
  ViperFinisher:
    TNT1 A 7 A_PlaySound("*strongmelee")
	TNT1 A 0 Thrustthing(angle*256/360,9, 0, 0)
    TNT1 A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
	TNT1 A 0 A_SetPitch(pitch - 0.5)
	TNT1 A 0 A_SetAngle(angle + (frandom(-0.3,0.3)))
    111R ABC 1
    111R D 3 A_TSP_Melee(18+2+2+12,90,"StrongMeleePuff",0,16,8)//A_CustomPunch(18,0,0,"StrongMeleePuff",90)
    Goto ViperFinisherA
	
// K-K-K END
  ViperFinisherA:
    111R EFG 1
    TNT1 A 6
    Goto AfterMelee
	
// P-P-K DEFAULT
  StreetSweeperFinisher:
    TNT1 A 4 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
    MK1F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"StreetSweeperFinisherBerserk")
    MK1F D 1 A_TSP_Melee(18+2+2+2,90,"StrongMeleePuff")//A_CustomPunch(18,0,0,"StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    Goto StreetSweeperFinisherA

// P-P-K END
  StreetSweeperFinisherA:
    MK1F EFGHI 1
    TNT1 A 5
    Goto AfterMelee

// P-P-P-K DEFAULT
  AzureKnee:
    TNT1 A 2
    ML2F A 0 A_PlaySoundEX("basicmelee/miss", "SoundSlot5")
    MK2F ABC 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"AzureKneeBerserk")
    MK2F D 3 A_TSP_Melee(12,70,"BasicMeleePuff")//A_CustomPunch(12,0,0,"BasicMeleePuff",70)
    Goto AzureKneeA
  AzureKneeBerserk:
    MK2F D 3 A_CustomPunch(24,0,0,"BasicMeleePuff",70)
    Goto AzureKneeA

// P-P-P-K END
  AzureKneeA:
    MK2F CB 1
    TNT1 A 0 A_GiveInventory("MelAlternateCombo", 4)
    TNT1 A 0 A_GiveInventory("ComboCoolDown", 1)
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    MK2F A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 0 A_JumpIfInventory("TraitPressed",1,"SPTrait")
    TNT1 A 1 A_WeaponReady
    TNT1 A 6
    Goto AfterMelee

// P-P-P-K-K DEFAULT
  StingRayFinisher:
    TNT1 A 3 A_PlaySound("*strongmelee")
    ML2F A 0 A_PlaySoundEX("strongmelee/miss", "SoundSlot5")
    MK3F ABCD 1
    ML1F D 0 A_JumpIfInventory("PowerStrength",1,"StingRayFinisherBerserk")
    MK3F E 1 A_TSP_Melee(18+2+2+2,90,"StrongMeleePuff")/*A_CustomPunch(18,0,0,"StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(2,0,0,"BlankMeleePuff",90)*/
    Goto StingRayFinisherA
  StingRayFinisherBerserk:
    MK3F E 1 A_CustomPunch(36,0,0,"StrongMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    MK3F E 0 A_CustomPunch(4,0,0,"BlankMeleePuff",90)
    Goto StingRayFinisherA

// P-P-P-K-K END
  StingRayFinisherA:
    MK3F FGHI 1
    TNT1 A 0 A_GiveInventory("MelPistolCombo", 1)//allows you to do the pistol combo
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_TakeInventory("MelAlternateCombo", 99)
    TNT1 A 0 A_TakeInventory("MelMachCombo", 99)
    TNT1 A 5 A_WeaponReady
    Goto AfterMelee

// MELEE COOLDOWN
  AfterMelee:
    TNT1 A 0 A_TakeInventory("MelPrimaryCombo", 99)
    TNT1 A 0 A_TakeInventory("MelAlternateCombo", 99)
    TNT1 A 0 A_TakeInventory("MelMachCombo", 99)
    TNT1 A 0 A_TakeInventory("MelPistolCombo", 99)
    TNT1 A 0 A_TakeInventory("MagPushToken", 99)
    TNT1 A 0 A_TakeInventory("MagSlingToken", 99)
    TNT1 A 0 A_TakeInventory("ChargedAttack", 99)
    TNT1 A 0 A_TakeInventory("ComboCoolDown", 99)
    111U ABC 1
    111G A 1
    Goto Ready

  SPTraitStart:
    111U CBA 1 
	Goto SPTrait
  }
}


ACTOR ChargedAttack: Inventory
{
  Inventory.MaxAmount 99
  Inventory.Icon TNT1A0
}